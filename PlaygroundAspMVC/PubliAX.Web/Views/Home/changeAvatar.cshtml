
@{
    ViewBag.Title = "changeAvatar";
    Layout = "~/Views/Shared/_LayoutGentelella.cshtml";

    PubliAX.Domain.DTO.UserDto loginUser = User.Identity.IsAuthenticated ? ViewData["LoginUser"] as PubliAX.Domain.DTO.UserDto : null;

    var _avatar = "~/Libs/Img/user.png";
    if (!string.IsNullOrEmpty(loginUser.avatar))
    {
        _avatar = loginUser.avatar;
    }
}

<h2>Alteração de Imagem de Perfil de Usuário</h2>


@using (Html.BeginForm("changeAvatar", "Home", FormMethod.Post,
                            new { enctype = "multipart/form-data" }))
{
    <hr />
    <div class="form-group">
        <div class="col-md-10">
            <img id="avatar" src="@VirtualPathUtility.ToAbsolute(_avatar)" />
        </div>
    </div>

    <div class="form-group">
        <div class="col-md-10">
            <label for="file">Upload Image:</label>
            <input type="file" name="file" id="file" style="width: 100%;" />
        </div>
    </div>

    <div class="form-group">
        <div class="col-md-10">
            <input type="submit" class="btn btn-primary"  value="Salvar" />
        </div>
    </div>
}


<div>
    @Html.ActionLink("[ Voltar ]", "profile")
</div>

@section Scripts {
    <script>
        $(function () {

            function readURL(input) {

                if (input.files && input.files[0]) {
                    var reader = new FileReader();

                    reader.onload = function (e) {
                        $('#avatar').attr('src', e.target.result);
                    }

                    reader.readAsDataURL(input.files[0]);
                }
            };

            $("#file").change(function () {
                readURL(this);
            });
        });

    </script>
}
